å®Œæˆäº†å·®å¼‚è¡¨è¾¾åˆ†æï¼Œå¾—åˆ°äº†æ˜¾è‘—åŸºå› åˆ—è¡¨ def_filteredï¼Œå¹¶è¿›è¡Œäº† KEGG å¯Œé›†åˆ†æã€‚ç°åœ¨ä½ æƒ³çŸ¥é“ï¼š

KEGG å¯Œé›†ç»“æœä¸­ï¼Œå“ªäº›æ˜¾è‘—åŸºå› å‚ä¸äº†å“ªäº›é€šè·¯ï¼Ÿ

è¿™æ­£æ˜¯ KEGG åˆ†æçš„æ ¸å¿ƒä»·å€¼ï¼ä¸‹é¢æ˜¯ä½ åœ¨ Python ä¸­çš„æ“ä½œæµç¨‹ï¼Œå‡è®¾ä½ ä½¿ç”¨çš„æ˜¯ `gseapy.enrichr()`ï¼š

âœ… ç¬¬ä¸€æ­¥ï¼šè¿è¡Œ KEGG å¯Œé›†åˆ†æ
```python
import gseapy as gp

gene_list = def_filtered.index.tolist()  # æ˜¾è‘—åŸºå› åç§°åˆ—è¡¨

kegg_results = gp.enrichr(
    gene_list=gene_list,
    gene_sets='KEGG_2021_Human',  # æˆ– KEGG_2021_Mouse / Rat
    organism='Human',
    outdir=None,
    cutoff=0.05
)
```
âœ… ç¬¬äºŒæ­¥ï¼šæŸ¥çœ‹ KEGG é€šè·¯ä¸åŸºå› çš„å¯¹åº”å…³ç³»
```python
import pandas as pd

# æå– KEGG ç»“æœ
results = kegg_results.results

# æ‹†åˆ† Genes åˆ—ä¸ºå•ä¸ªåŸºå› 
kegg_map = results[['Term', 'Genes']].copy()
kegg_map['Genes'] = kegg_map['Genes'].str.split(';')  # æœ‰æ—¶æ˜¯ ','ï¼Œä½ å¯ä»¥å…ˆ print(results['Genes'][0]) çœ‹åˆ†éš”ç¬¦
kegg_map = kegg_map.explode('Genes').rename(columns={'Term': 'KEGG_Pathway', 'Genes': 'Gene'})
kegg_map['Gene'] = kegg_map['Gene'].str.strip()

# æŸ¥çœ‹å‰å‡ è¡Œ
print(kegg_map.head())
```

ğŸ§¾è¾“å‡ºç¤ºä¾‹
|KEGG_Pathway|	Gene
|---|---
|Apoptosis|	CASP3
|Apoptosis|	BAX
|TNF signaling pathway	|TNF
|TNF signaling pathway	|NFKB1

è¿™æ ·ä½ å°±å¾—åˆ°äº†ä¸€ä¸ªæ¸…æ™°çš„â€œåŸºå› -é€šè·¯â€æ˜ å°„è¡¨ã€‚

âœ… ç¬¬ä¸‰æ­¥ï¼šç­›é€‰æŸä¸ªé€šè·¯çš„å‚ä¸åŸºå› 
æ¯”å¦‚ä½ æƒ³çœ‹ â€œMAPK signaling pathwayâ€ çš„åŸºå› ï¼š

```python
kegg_map[kegg_map['KEGG_Pathway'].str.contains('MAPK', case=False)]
```

âœ… ç¬¬å››æ­¥ï¼šç»Ÿè®¡æ¯ä¸ªåŸºå› å‚ä¸çš„é€šè·¯æ•°é‡
```python
gene_counts = kegg_map['Gene'].value_counts()
print(gene_counts.head())
```
è¿™å¯ä»¥å¸®ä½ æ‰¾å‡ºâ€œé€šè·¯æ¢çº½åŸºå› â€ï¼Œå³å‚ä¸å¤šä¸ª KEGG é€šè·¯çš„å…³é”®åŸºå› ã€‚

âœ… ç¬¬äº”æ­¥ï¼šå¯è§†åŒ– `KEGG` é€šè·¯ä¸åŸºå› å…³ç³»ï¼ˆå¯é€‰ï¼‰
ä½ å¯ä»¥ç”¨ `networkx` æˆ– `plotly` ç”»å‡º `KEGG` é€šè·¯ä¸åŸºå› çš„ç½‘ç»œå›¾ã€‚å¦‚æœä½ æƒ³è¦è¿™éƒ¨åˆ†ï¼Œæˆ‘å¯ä»¥å¸®ä½ å†™ä¸€æ®µå›¾å½¢åŒ–è„šæœ¬ã€‚
