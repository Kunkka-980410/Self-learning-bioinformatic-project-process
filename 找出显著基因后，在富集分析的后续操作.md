完成了差异表达分析，得到了显著基因列表 def_filtered，并进行了 KEGG 富集分析。现在你想知道：

KEGG 富集结果中，哪些显著基因参与了哪些通路？

这正是 KEGG 分析的核心价值！下面是你在 Python 中的操作流程，假设你使用的是 `gseapy.enrichr()`：

✅ 第一步：运行 KEGG 富集分析
```python
import gseapy as gp

gene_list = def_filtered.index.tolist()  # 显著基因名称列表

kegg_results = gp.enrichr(
    gene_list=gene_list,
    gene_sets='KEGG_2021_Human',  # 或 KEGG_2021_Mouse / Rat
    organism='Human',
    outdir=None,
    cutoff=0.05
)
```
✅ 第二步：查看 KEGG 通路与基因的对应关系
```python
import pandas as pd

# 提取 KEGG 结果
results = kegg_results.results

# 拆分 Genes 列为单个基因
kegg_map = results[['Term', 'Genes']].copy()
kegg_map['Genes'] = kegg_map['Genes'].str.split(';')  # 有时是 ','，你可以先 print(results['Genes'][0]) 看分隔符
kegg_map = kegg_map.explode('Genes').rename(columns={'Term': 'KEGG_Pathway', 'Genes': 'Gene'})
kegg_map['Gene'] = kegg_map['Gene'].str.strip()

# 查看前几行
print(kegg_map.head())
```

🧾输出示例
|KEGG_Pathway|	Gene
|---|---
|Apoptosis|	CASP3
|Apoptosis|	BAX
|TNF signaling pathway	|TNF
|TNF signaling pathway	|NFKB1

这样你就得到了一个清晰的“基因-通路”映射表。

✅ 第三步：筛选某个通路的参与基因
比如你想看 “MAPK signaling pathway” 的基因：

```python
kegg_map[kegg_map['KEGG_Pathway'].str.contains('MAPK', case=False)]
```

✅ 第四步：统计每个基因参与的通路数量
```python
gene_counts = kegg_map['Gene'].value_counts()
print(gene_counts.head())
```
这可以帮你找出“通路枢纽基因”，即参与多个 KEGG 通路的关键基因。

✅ 第五步：可视化 `KEGG` 通路与基因关系（可选）
你可以用 `networkx` 或 `plotly` 画出 `KEGG` 通路与基因的网络图。如果你想要这部分，我可以帮你写一段图形化脚本。
