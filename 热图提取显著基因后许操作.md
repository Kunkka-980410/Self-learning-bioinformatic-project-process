## 提取显著基因绘制热图后续的操作  
**思路**：根据热图的前xx个显著基因来富集分析，然后再从富集分析里提取参数通路数最多的基因去交集来判断

✅ 你的策略逻辑
热图前100个显著基因：代表表达变化最剧烈的核心基因。

富集分析（如 `KEGG`、`GO`）：找出这些基因参与的功能通路。

统计每个基因参与的通路数量：识别“通路枢纽基因”。

从中筛选参与通路最多的基因：这些基因可能是调控核心。

与其他分析结果交集（如 `DEG`、`hub gene`）：进一步验证其生物学意义  

🧪 Python 实现思路（以 `KEGG` 为例）
① 提取热图前100个基因
```python
top_genes = deg_filtered.sort_values('neg_log10_pval', ascending=False).head(100).index.tolist()
```
② 富集分析（`gseapy`）
```python
import gseapy as gp

kegg_results = gp.enrichr(
    gene_list=top_genes,
    gene_sets='KEGG_2021_Human',
    organism='Human',
    outdir=None,
    cutoff=0.05
)
```  
③ 构建“基因-通路”映射表
```python
import pandas as pd

results = kegg_results.results.copy()
results['Genes'] = results['Genes'].str.split(';')
gene_pathway_map = results[['Term', 'Genes']].explode('Genes')
gene_pathway_map['Genes'] = gene_pathway_map['Genes'].str.strip()
```  
④ 统计每个基因参与的通路数量
```python
gene_counts = gene_pathway_map['Genes'].value_counts()
top_hub_genes = gene_counts[gene_counts >= gene_counts.max()].index.tolist()
```  
⑤ 与 `DEG` 或 `hub gene` 交集
```python
intersection = set(top_hub_genes).intersection(set(def_filtered.index))
print("参与通路最多且显著差异的基因:", intersection)
```  
🧠 生物学意义
这些基因既表达显著变化，又参与多个通路，可能是调控网络的“枢纽节点”

可用于后续：

🔬 实验验证（`qPCR`、`Western blot`）

🧬 网络分析（`PPI`、`模块挖掘`）

💊 靶点筛选（`药物设计`）
