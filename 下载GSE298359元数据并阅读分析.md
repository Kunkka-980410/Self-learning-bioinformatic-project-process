# GSE298359
## 目录
- [数据集简介](#数据集简介)
- [读取文件并分析](#读取文件并分析)
- [开始分析流程](#开始分析流程)

---
### 数据集简介
**标题** 通过增强线粒体外膜稳定性并清除胞外DNA（exDNA）的协同细胞器-微环境调控策略治疗IVDD  
**实验动物** ：大鼠(Rattus norvegicus)  

**实验类型** ：高通量测序(GPL25947)  

**细胞类型：髓核(NP)RNA-seq**    

**数据类型**  ：
|未处理型(NC)|阿霉素诱导衰老(SEN)|BNPMT介入阿奇霉素诱导的髓核细胞衰老|
|---|---|---
|GSM9012300\1\2|GSM9012303\4\5|GSM9012306\7\8|   

**Downfamily**：
- 1.`SOFTformatted`（用于描述基因表达实验的数据和元信息）,
- 2.`MiNiML`（包含1.Sample 信息，2.Platform 信息，
- 3.`Series` 信息样本之间的关系（如对照 vs 处理组），
- 4.`Data Processing` 信息
数据归一化方法
背景校正
表达量计算方式等
- 5.`Citation` （联系信息等）

**Series Matrix**：  
是 GEO（Gene Expression Omnibus）数据库中最常用的数据格式之一，专门用于存储表达矩阵数据  
🧬 Series Matrix 文件主要内容结构
通常包含以下几个部分：

1. 元信息（Metadata）
以 ! 开头，描述实验设计、样本信息等：

```Code
!Series_title = Gene expression profiling of liver tissue
!Sample_title = GSM123456
!Sample_source_name = liver
!Sample_characteristics = treatment: drug A
```
2. 表达矩阵（Expression Matrix）
以 `ID_REF` 开头的表格部分：

```Code
ID_REF    GSM123456    GSM123457    GSM123458
1007_s_at    5.23    5.67    5.12
1053_at      4.89    4.95    4.76
```
`ID_REF` 是探针或基因的标识符

每列是一个样本（GSM编号）

每个单元格是表达量（通常是 `log2` 转换后的值）


**Supplement files**：  
`FPKM_anno.txt.gz`：基因表达矩阵 + 注释信息  
`RAW.tar`：包含每个样本的表达值  
`counts_anno.txt.gz`：基因表达矩阵 + 注释信息表格，非常适合用于 `bulk RNA-seq` 或 `microarray` 分析

---
### 读取文件并分析  
📦 文件类型解析
文件名： `GSE298359_FPKM_anno_txt.gz`

|部分|	含义
|---|---
|`GSE298359`|`	GEO` 数据集编号
|`FPKM`|	表达量单位：Fragments Per Kilobase of transcript per Million mapped reads（常用于 RNA-seq）
|`anno`|	包含注释信息（如基因名、功能、GO、通路等）
|`txt`|	纯文本格式，通常是制表符分隔
|`gz`|	gzip 压缩格式，需要解压后使用（如用 `pandas.read_csv(..., compression='gzip'`)）

🧬 数据内容结构（典型）
通常包含：
行：每一行是一个基因
列：前几列是注释信息（如 id, description, GO_term, pathway）

后面是样本表达量（如 Sample1, Sample2, …）

📊 差异表达分析处理流程
如果你想做差异基因分析（如比较处理组 vs 对照组），推荐如下步骤：

1️⃣ 解压并读取数据
```python
import pandas as pd

df = pd.read_csv('GSE298359_FPKM_anno_txt.gz', sep='\t', compression='gzip')
```
2️⃣ 🔍 表达量过滤（是的，建议过滤）
为什么要过滤低表达基因？
去除背景噪音
提高统计功效
避免虚假差异
常见过滤策略：

```python
# 假设样本列是从第1列到第9列
expr = df.iloc[:, 1:10]

# 过滤：至少有一半样本表达量 > 1
filtered = df[expr.gt(1).sum(axis=1) >= (expr.shape[1] // 2)]
```
你也可以用 CPM、TPM 或 log2(FPKM+1) 后再过滤。

3️⃣ 📐 分组信息准备
你需要知道哪些样本属于哪一组，例如：

```python
group = ['BNPMT']*3 + ['NC']*3 + ['SEN']*3
```
4️⃣ 📈 差异分析（推荐工具）  
`Python：statsmodels, scipy, DESeq2 via rpy2`

`R：DESeq2, edgeR, limma-voom（更主流）`  
5️⃣ 🎨 可视化
火山图（Volcano plot）

热图（Heatmap）

PCA 主成分分析

✅ 总结建议
|步骤|	是否建议|	理由
|---|---|---
|表达量过滤	|✅ 强烈建议	|去除低表达基因，提升分析质量
|log2 转换	|✅ 建议	|稳定方差，适合统计建模
|分组清晰	|✅ 必须	|差异分析依赖分组信息
|使用 R 包|	✅ 推荐|	DESeq2/edgeR 更成熟，适合 bulk RNA-seq  


---
### 开始分析流程  
**Python 中模拟limma其核心思想**：  
🧠 limma 的核心原理  
limma 的全称是 Linear Models for Microarray Data，核心流程包括：  
1.构建线性模型：表达量 ~ 组别  
2.使用经验贝叶斯方法稳定方差估计  
3.计算 log2 fold change 和 p 值  
4.多重检验校正（如 Benjamini-Hochberg）  

✅ 总结
|步骤|	Python工具|	对应limma功能
|---|---|---
|设计矩阵|`	patsy`|`	model.matrix`
|线性建模|`	statsmodels.OLS`|`	lmFit`
|多重校正|`	multipletests`|`	eBayes + topTable`
|可视化	|`matplotlib`|`	volcanoplot`  


