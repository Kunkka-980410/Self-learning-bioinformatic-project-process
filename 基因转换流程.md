✅ Ensembl ID → Gene Symbol 转换（支持混合返回）

✅ 分批处理避免请求过大

✅ 日志记录失败批次和失败 ID

✅ 富集分析（KEGG / GO）

✅ 可视化结果（条形图 / 气泡图）
🧰 模块化设计建议
你可以把整个流程封装成一个 Python 文件，比如叫 rna_enrichment_pipeline.py，结构如下：

🔹 1. convert_ensembl_to_symbol()
分批处理

自动识别返回类型

记录失败 ID 到 failed_ids.txt
🔹 2. run_enrichr()
接收 gene symbol 列表

支持 KEGG / GO / Reactome 等数据库

自动保存结果到 CSV
🔹 3. main()
接收差异表达结果（如 results_df）

自动筛选显著基因

调用转换 + 富集分析 + 可视化
📦 示例模块入口（伪代码）
```python
def main(results_df, alpha=0.1, fc_threshold=0.5):
    sig_genes = results_df[
        (results_df['p_adj'] < alpha) & 
        (np.abs(results_df['log2FC']) > fc_threshold)
    ].index.tolist()

    gene_symbols = convert_ensembl_to_symbol(sig_genes)

    enr = run_enrichr(gene_symbols, gene_sets='KEGG_2021_Human', outdir='KEGG_results')
    gp.barplot(enr.results, title='KEGG Pathway Enrichment', ofname='KEGG_barplot.png')
```


可选生成图像文件
